"use strict";angular.module("rsgraphsApp",["ngAnimate","ngCookies","ngResource","ui.router","ngSanitize","ngTouch","chart.js","ui.select"]).config(["$sceDelegateProvider","$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c,d){a.resourceUrlWhitelist(["**"]),d.html5Mode(!0),b.state("dashboard",{url:"/",templateUrl:"views/dashboard.html",controller:"DashboardCtrl",controllerAs:"dashCtrl"}).state("graph",{url:"/graph/:id",templateUrl:"views/graph.html",controller:"GraphCtrl",controllerAs:"graphCtrl"}),c.otherwise("/")}]).run(["$rootScope","$state","$stateParams","RSUtils",function(a,b,c,d){a.$state=b,a.$stateParams=c,a.allItemsList=[],d.getAllItems().then(function(b){for(var c in b.data){var d=b.data[c];angular.extend(d,{icon:"https://services.runescape.com/m=itemdb_oldschool/1504002634353_obj_sprite.gif?id="+c}),a.allItemsList.push(d)}})}]),function(){function a(a){function b(b){var c={params:{item:b}};return a.get("https://cors-anywhere.herokuapp.com/https://services.runescape.com/m=itemdb_oldschool/api/catalogue/detail.json",c)}function c(b){var c={params:{a:"graph",i:b,g:30,start:moment().subtract(4,"weekxs").valueOf()}};return a.get("https://cors-anywhere.herokuapp.com/https://api.rsbuddy.com/grandExchange",c)}function d(){return a.get("https://cors-anywhere.herokuapp.com/https://rsbuddy.com/exchange/summary.json")}return{getInfo:b,getPrices:c,getAllItems:d}}angular.module("rsgraphsApp").factory("RSUtils",a),a.$inject=["$http"]}(),angular.module("rsgraphsApp").controller("DashboardCtrl",function(){this.hi="hi",this.help="test"}),function(){function a(a,b,c){function d(){var d=b.id;a.getInfo(d).then(function(a){e.item=a.data.item}),a.getPrices(d).then(function(a){e.data=a.data,e.dates=e.data.map(function(a){return c("date")(a.ts,"MMM dd - h:mm a")}),e.buyPrice=e.data.map(function(a){return void 0===a.buyingPrice?void 0:a.buyingPrice}),e.sellPrice=e.data.map(function(a){return void 0===a.sellingPrice?void 0:a.sellingPrice}),e.buyVolume=e.data.map(function(a){return a.buyingCompleted}),e.sellVolume=e.data.map(function(a){return a.sellingCompleted}),e.series=["Buy Price","Sell Price"],e.chartData=[e.buyPrice,e.sellPrice],e.timestamps=angular.copy(e.dates),e.dateRange=e.buyPrice.length,e.options={spanGaps:!0,pointRadius:1,scales:{yAxes:[{ticks:{callback:function(a){return c("number")(a)}}}]}}})}var e=this;d(),e.isNotUndefined=function(a,b,c){return void 0!==a},e.logData=function(){console.log(e.chartData)},e.updateData=function(a){console.log("updating data range to : "+a),0===a?(e.chartData=[e.buyPrice,e.sellPrice],e.timestamps=angular.copy(e.dates)):(e.chartData=[c("limitTo")(e.buyPrice,a),c("limitTo")(e.sellPrice,a)],e.timestamps=c("limitTo")(angular.copy(e.dates),a)),console.log(e.chartData)}}angular.module("rsgraphsApp").controller("GraphCtrl",a),a.$inject=["RSUtils","$stateParams","$filter"]}(),angular.module("rsgraphsApp").run(["$templateCache",function(a){a.put("views/dashboard.html",'<div class="row"> <div class="col-xs-12"> <h1 class="text-center">Select an item from the list!</h1> </div> </div> <div class="row" ng-if="false"> <div class="col-xs-12 col-md-6"> <h3>Rising prices</h3> <ul> <li ng-bind="dashCtrl.hi"></li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> </ul> </div> <div class="col-xs-12 col-md-6"> <h3>Falling prices</h3> <ul> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> </ul> </div> </div> <div class="row" ng-if="false"> <div class="col-xs-12 col-md-6"> <h3>Watchlist</h3> <ul> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> </ul> </div> <div class="col-xs-12 col-md-6"> <h3>Most valuable items</h3> <ul> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> <li>Lorem Ipsum #1</li> </ul> </div> </div>'),a.put("views/graph.html",'<div class="row"> <div class="col-xs-12 col-sm-2"> <div class="panel panel-default"> <div class="panel-body"> <h4 class="rs-boldFont text-center" ng-bind="graphCtrl.item.name"></h4> <img class="center-block" ng-src="{{graphCtrl.item.icon_large}}"> <p class="text-center" ng-bind="graphCtrl.item.description"></p> </div> <ul class="list-group"> <li id="buy-price" class="list-group-item">Buy Price: <span ng-bind="(graphCtrl.buyPrice | filter: graphCtrl.isNotUndefined | limitTo: -1)[0] | number : 0"></span></li> <li id="sell-price" class="list-group-item">Sell Price: <span ng-bind="(graphCtrl.sellPrice | filter: graphCtrl.isNotUndefined | limitTo: -1)[0] | number : 0"></span></li> <li id="buy-volume" class="list-group-item">Buy Volume: <span ng-bind="(graphCtrl.buyVolume | filter: graphCtrl.isNotUndefined | limitTo: -1)[0] | number : 0"></span></li> <li id="sell-volume" class="list-group-item">Sell Volume: <span ng-bind="(graphCtrl.sellVolume | filter: graphCtrl.isNotUndefined | limitTo: -1)[0] | number : 0"></span></li> </ul> </div> </div> <div class="col-xs-12 col-sm-2 pull-right"> <div class="panel panel-default"> <div class="panel-heading"> <h3 class="panel-title">Graph Functions</h3> </div> <div class="panel-body text-center"> <div class="row"> <div class="col-xs-12"> <span class="rs-boldFont">Data Range</span> <div class="btn-group" data-toggle="buttons" role="group" aria-label="Data Ranges"> <button class="btn btn-default" ng-click="graphCtrl.updateData(-336)"> <input type="radio" name="dateRange">1 Week </button> <button class="btn btn-default" ng-click="graphCtrl.updateData(-672)"> <input type="radio" name="dateRange">2 Weeks </button> <button class="btn btn-default active" ng-click="graphCtrl.updateData(0)"> <input type="radio" name="dateRange">All</button> </div> </div> </div> <div class="row"> <div class="col-xs-12"> </div> </div> </div> </div> </div> <div class="col-xs-12 col-sm-8"> <canvas id="line" class="chart chart-line" chart-data="graphCtrl.chartData" chart-labels="graphCtrl.timestamps" chart-series="graphCtrl.series" chart-options="graphCtrl.options"> </canvas> </div> </div>')}]);